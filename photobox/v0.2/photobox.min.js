/**
 * Photobox
 * 
 * @version 0.1
 * @since 2020-11-18
 * 
 * @param {object} options
 * @return {object}
 */
function Photobox(e){const t=this,n={selectors:{gallery:".photoboxGallery",image:".photoboxImage"},classes:{container:"photoboxContainer",content:"photoboxContent",contentImage:"photoboxContentImage",contentTitle:"photoboxContentTitle",navigation:"photoboxNavigation",close:"photoboxClose",previous:"photoboxDirection photoboxPrevious",next:"photoboxDirection photoboxNext",visible:"photoboxVisible"},buttonContent:{close:"",previous:"",next:""},loader:"data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",keyboardControl:!0};this.construct=function(e){this.params=this.merge(n,e),this.params.galleries=[...document.querySelectorAll(this.params.selectors.gallery)],this.generateMarkup(),this.initGalleries(),this.params.keyboardControl&&document.addEventListener("keyup",function(e){t.initKeyboardControl(e.code)})},this.initKeyboardControl=function(e){switch(e){case"Escape":this.close();break;case"ArrowRight":this.openImage(this.getNext());break;case"ArrowLeft":this.openImage(this.getPrevious())}},this.initGalleries=function(){for(let e=0;e<this.params.galleries.length;e++){let t=this.params.galleries[e];t.images=[...t.querySelectorAll(this.params.selectors.image)],this.addImageClickEvent(this.params.galleries[e].images)}},this.addImageClickEvent=function(e){for(let n of e)n.addEventListener("click",function(){let s=n.closest(t.params.selectors.gallery);t.setActiveGallery(s,e),t.openImage(n)})},this.setActiveGallery=function(e,t){this.params.currentGallery=e,this.params.currentGallery.images=t},this.openImage=function(e){if(null==e)return;let t=this.params.container.content.contentImage,n=this.params.container.content.contentTitle;t.src=e.src,t.alt=e.alt,n.innerHTML=e.alt,this.params.currentImage=e,this.open()},this.open=function(){this.params.container.classList.add(t.params.classes.visible)},this.close=function(){this.params.container.classList.remove(this.params.classes.visible)},this.getNext=function(){let e=this.params.currentImage,t=this.params.currentGallery,n=this.getActiveImageIndex(t,e);if(t.length!==n)return t.images[n+1]},this.getPrevious=function(){let e=this.params.currentImage,t=this.params.currentGallery,n=this.getActiveImageIndex(t,e);if(!(0>=n))return t.images[n-1]},this.getActiveImageIndex=function(e,t){return e.images.indexOf(t)},this.generateMarkup=function(){let e=this.createContainer();e.navigation=this.createNavigation(),e.content=this.createContent(),e.appendChild(e.navigation),e.appendChild(e.content),this.params.container=e;let t=document.body,n=t.querySelector("script");t.insertBefore(e,n)},this.createContainer=function(){let e=document.createElement("div");return e.className=this.params.classes.container,e},this.createContent=function(){let e=document.createElement("div");return e.classList.add(this.params.classes.content),e.contentImage=this.createContentImage(),e.contentTitle=this.createContentTitle(),e.appendChild(e.contentImage),e.appendChild(e.contentTitle),e},this.createContentImage=function(){let e=document.createElement("img");return e.className=this.params.classes.contentImage,e.src=this.params.loader,e.alt="Loading ...",e},this.createContentTitle=function(){let e=document.createElement("span");return e.className=this.params.classes.contentTitle,e},this.createNavigation=function(){let e=document.createElement("div");return e.className=this.params.classes.navigation,e.close=this.createClose(),e.previous=this.createPrevious(),e.next=this.createNext(),e.appendChild(e.close),e.appendChild(e.previous),e.appendChild(e.next),e},this.createClose=function(){let e=document.createElement("span");return e.className=this.params.classes.close,e.innerHTML=this.params.buttonContent.close,e.addEventListener("click",function(){t.close()},!1),e},this.createPrevious=function(){let e=document.createElement("span");return e.className=this.params.classes.previous,e.innerHTML=this.params.buttonContent.previous,e.addEventListener("click",function(){t.openImage(t.getPrevious())}),e},this.createNext=function(){let e=document.createElement("span");return e.className=this.params.classes.next,e.innerHTML=this.params.buttonContent.next,e.addEventListener("click",function(){t.openImage(t.getNext())}),e},this.merge=function(e,t){if(null==t)return e;for(let n of Object.keys(t))t[n]instanceof Object&&e.hasOwnProperty(n)&&Object.assign(t[n],this.merge(e[n],t[n]));return Object.assign(e||{},t),e},this.construct(e)}